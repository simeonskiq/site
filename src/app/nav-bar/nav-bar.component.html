<nav class="navbar" [class.hidden]="!isNavbarVisible">
  <div class="navbar-content">
    <div class="logo">
      <a routerLink="/" (click)="closeMobileMenu()">
        <img src="/images/hotel-logo.png" alt="Aurora Hotel" class="logo-image">
      </a>
    </div>
    
    <!-- Hamburger Menu Button -->
    <button class="hamburger-menu" (click)="toggleMobileMenu()" [class.active]="showMobileMenu" aria-label="Toggle menu">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <!-- Desktop Navigation -->
    <div class="nav-links">
      <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" (click)="closeMobileMenu()">{{ 'nav.home' | translate }}</a>
      <a routerLink="/about" routerLinkActive="active" (click)="closeMobileMenu()">{{ 'nav.about' | translate }}</a>
      <a routerLink="/booking" routerLinkActive="active" (click)="closeMobileMenu()">{{ 'nav.booking' | translate }}</a>
      <a routerLink="/contact" routerLinkActive="active" (click)="closeMobileMenu()">{{ 'nav.contact' | translate }}</a>
    </div>
    <div class="auth-links" *ngIf="isBrowser">
      <ng-container *ngIf="!isAuthenticated">
        <a routerLink="/login" routerLinkActive="active" class="auth-link">{{ 'nav.signIn' | translate }}</a>
        <a routerLink="/register" routerLinkActive="active" class="auth-link auth-link-primary">{{ 'nav.register' | translate }}</a>
      </ng-container>
      <ng-container *ngIf="isAuthenticated">
        <div class="user-menu" (click)="$event.stopPropagation()">
          <!-- Notifications bell -->
          <div class="notifications-menu">
            <button class="notif-button" type="button" (click)="toggleNotificationsMenu(); $event.stopPropagation()" aria-label="Notifications">
              <span class="notif-icon" aria-hidden="true">
                <!-- inline bell svg -->
                <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                  <path d="M12 22a2.5 2.5 0 0 0 2.45-2h-4.9A2.5 2.5 0 0 0 12 22Zm7-6V11a7 7 0 0 0-5-6.71V3a2 2 0 1 0-4 0v1.29A7 7 0 0 0 5 11v5l-2 2v1h20v-1l-2-2Z"/>
                </svg>
              </span>
              <span class="notif-badge" *ngIf="unreadCount > 0">{{ unreadCount }}</span>
            </button>

            <div class="notif-dropdown" *ngIf="showNotificationsMenu" (click)="$event.stopPropagation()">
              <div class="notif-header">
                <div class="notif-title">Notifications</div>
                <div class="notif-header-buttons" *ngIf="notifications.length > 0">
                  <button type="button" class="notif-readall" (click)="markAllNotificationsRead()">Read all</button>
                  <button type="button" class="notif-clearall" (click)="clearAllNotifications()">Clear all</button>
                </div>
              </div>
              <div class="notif-list" *ngIf="notifications.length; else emptyNotif">
                <div
                  class="notif-item-wrapper"
                  *ngFor="let n of notifications"
                  [class.unread]="!n.read"
                >
                  <button
                    type="button"
                    class="notif-item"
                    (click)="openNotification(n)"
                  >
                    <div class="notif-item-title">{{ n.title }}</div>
                    <div class="notif-item-message">{{ n.message }}</div>
                    <div class="notif-item-time">{{ n.createdAt | date:'short' }}</div>
                  </button>
                  <button
                    type="button"
                    class="notif-close"
                    (click)="removeNotification(n, $event)"
                    aria-label="Close notification"
                  >
                    <svg viewBox="0 0 24 24" width="14" height="14" fill="currentColor">
                      <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                  </button>
                </div>
              </div>
              <ng-template #emptyNotif>
                <div class="notif-empty">No notifications</div>
              </ng-template>
            </div>
          </div>

          <button class="user-button" type="button" (click)="toggleUserMenu()">
            <span class="user-info">{{ currentUser?.firstName || currentUser?.email }}</span>
            <span class="caret">▼</span>
          </button>
          <div class="user-dropdown" *ngIf="showUserMenu">
            <button *ngIf="isAdmin" class="dropdown-item" type="button" routerLink="/admin" (click)="closeUserMenu()">
              {{ 'nav.adminPanel' | translate }}
            </button>
            <button class="dropdown-item" type="button" routerLink="/profile" (click)="closeUserMenu()">
              {{ 'nav.myProfile' | translate }}
            </button>
            <button class="dropdown-item" type="button" routerLink="/my-reservations" (click)="closeUserMenu()">
              {{ 'nav.myReservations' | translate }}
            </button>
            <button class="dropdown-item" type="button" (click)="logout(); closeUserMenu()">
              {{ 'nav.logout' | translate }}
            </button>
          </div>
        </div>
      </ng-container>
    </div>
    <div class="language-selector">
      <div class="language-options">
        <button 
          class="lang-btn" 
          [class.active]="currentLang === 'en'"
          (click)="changeLanguage('en')"
          type="button">
          <img src="/images/flags/en-flag.png" alt="English" class="flag-image">
          <span class="lang-code">EN</span>
        </button>
        <button 
          class="lang-btn" 
          [class.active]="currentLang === 'bg'"
          (click)="changeLanguage('bg')"
          type="button">
          <img src="/images/flags/bg-flag.png" alt="Bulgarian" class="flag-image">
          <span class="lang-code">BG</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile Menu Overlay -->
  <div class="mobile-menu-overlay" [class.active]="showMobileMenu" (click)="closeMobileMenu()"></div>
  
  <!-- Mobile Menu Sidebar -->
  <div class="mobile-menu" [class.active]="showMobileMenu">
    <div class="mobile-menu-header">
      <h3>Aurora Hotel</h3>
      <button class="mobile-menu-close" (click)="closeMobileMenu()">&times;</button>
    </div>
    <div class="mobile-menu-links">
      <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" (click)="closeMobileMenu()">{{ 'nav.home' | translate }}</a>
      <a routerLink="/about" routerLinkActive="active" (click)="closeMobileMenu()">{{ 'nav.about' | translate }}</a>
      <a routerLink="/booking" routerLinkActive="active" (click)="closeMobileMenu()">{{ 'nav.booking' | translate }}</a>
      <a routerLink="/contact" routerLinkActive="active" (click)="closeMobileMenu()">{{ 'nav.contact' | translate }}</a>
      
      <div class="mobile-menu-divider"></div>
      
      <ng-container *ngIf="isBrowser && !isAuthenticated">
        <a routerLink="/login" routerLinkActive="active" (click)="closeMobileMenu()" class="mobile-auth-link">{{ 'nav.signIn' | translate }}</a>
        <a routerLink="/register" routerLinkActive="active" (click)="closeMobileMenu()" class="mobile-auth-link mobile-auth-primary">{{ 'nav.register' | translate }}</a>
      </ng-container>
      
      <ng-container *ngIf="isBrowser && isAuthenticated">
        <button *ngIf="isAdmin" class="mobile-menu-item" type="button" routerLink="/admin" (click)="closeMobileMenu()">
          {{ 'nav.adminPanel' | translate }}
        </button>
        <button class="mobile-menu-item" type="button" routerLink="/profile" (click)="closeMobileMenu()">
          {{ 'nav.myProfile' | translate }}
        </button>
        <button class="mobile-menu-item" type="button" routerLink="/my-reservations" (click)="closeMobileMenu()">
          {{ 'nav.myReservations' | translate }}
        </button>
        <button class="mobile-menu-item mobile-menu-logout" type="button" (click)="logout(); closeMobileMenu()">
          {{ 'nav.logout' | translate }}
        </button>
      </ng-container>
      
      <div class="mobile-menu-divider"></div>
      
      <div class="mobile-language-selector">
        <button 
          class="mobile-lang-btn" 
          [class.active]="currentLang === 'en'"
          (click)="changeLanguage('en')"
          type="button">
          <img src="/images/flags/en-flag.png" alt="English" class="flag-image">
          <span>English</span>
        </button>
        <button 
          class="mobile-lang-btn" 
          [class.active]="currentLang === 'bg'"
          (click)="changeLanguage('bg')"
          type="button">
          <img src="/images/flags/bg-flag.png" alt="Bulgarian" class="flag-image">
          <span>Български</span>
        </button>
      </div>
    </div>
  </div>
</nav>